"use strict";var express=require("express"),router=express.Router(),mongo=require("mongodb").MongoClient,uniqueValidator=require("mongoose-unique-validator"),_require=require("../models/packages"),Packages=_require.Packages,_require2=require("../models/booking1"),Booking1=_require2.Booking1,myarray=["ready for some exciting time","how are you today","good to see you","hope you are having a good day"];function checkAuthenticated(e,o,r){if(e.isAuthenticated())return r();o.redirect("/signup")}function getPackages(t,a){mongo.connect(process.env.MONGO_URL,{useNewUrlParser:!0,useUnifiedTopology:!0},function(e,o){if(e)throw e;var r=o.db("userdata").collection("packages"),n={};t&&(n.packid=t),r.find(n).toArray(function(e,o){a(e,o)})})}router.get("/",function(e,t,o){getPackages(null,function(e,o){if(e)throw e;var r=Math.floor(Math.random()*myarray.length),n=myarray[r];console.log(myarray[r]),t.render("index",{mypackages:o,greet_msg:"Welcome to our travel Portal, "+n,date_time:(new Date).toString()})})}),router.get("/details/det/:packageid",function(e,r,o){var n=e.params.packageid;console.log(n),getPackages(n,function(e,o){if(e)throw e;r.render("det",{mypackages:o,isdetails:!0})})}),router.post("/book",function(o,r,e){o.body;var n=new Booking1;n.userId=o.user,n.packageId=o.body.packageId,n.TravellerCount=o.body.TravellerCount,console.log(n.packageId),n.save(function(e){if(e)return processErrors(e,"det",o,r,o.body);r.redirect("book1")})}),router.get("/book1",function(e,r,o){Booking1.find({userId:e.user}).populate("packageId").exec(function(e,o){e&&console.log(e),r.render("book1",{booking1:o})})}),router.get("/return/:bookingid",function(e,o,r){var n=e.params.bookingid;Booking1.findOneAndDelete({_id:n},function(e){e&&console.log(e),o.redirect("/")})}),module.exports=router;
//# sourceMappingURL=index.min.js.map
