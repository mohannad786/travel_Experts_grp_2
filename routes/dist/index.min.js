"use strict";var express=require("express"),router=express.Router(),mongo=require("mongodb").MongoClient,uniqueValidator=require("mongoose-unique-validator"),_require=require("../models/packages"),Packages=_require.Packages,_require2=require("../models/booking1"),Booking1=_require2.Booking1,myarray=["ready for some exciting time","how are you today","good to see you","hope you are having a good day"];function getPackages(n,t){mongo.connect(process.env.MONGO_URL,{useNewUrlParser:!0,useUnifiedTopology:!0},function(e,o){if(e)throw e;var r=o.db("userdata").collection("packages"),a={};n&&(a.packid=n),r.find(a).toArray(function(e,o){t(e,o)})})}router.get("/",function(e,n,o){getPackages(null,function(e,o){if(e)throw e;var r=Math.floor(Math.random()*myarray.length),a=myarray[r];console.log(myarray[r]),n.render("index",{mypackages:o,greet_msg:"Welcome to our travel Portal, "+a,date_time:(new Date).toString()})})}),router.get("/details/det/:packageid",function(e,r,o){getPackages(e.params.packageid,function(e,o){if(e)throw e;r.render("det",{mypackages:o,isdetails:!0})})}),router.post("/book",function(o,r,e){o.body;var a=new Booking1;a.userId=3,a.packageId=o.body.packageId,a.TravellerCount=o.body.TravellerCount,a.save(function(e){if(e)return processErrors(e,"det",o,r,o.body);r.redirect("/book1")})}),router.get("/book1",function(e,r,o){Booking1.find({userId:3}).populate("packageId").exec(function(e,o){e&&console.log(e),r.render("book1",{booking1:o})})}),router.get("/return/:bookingid",function(e,o,r){var a=e.params.bookingid;Booking1.findOneAndDelete({_id:a},function(e){e&&console.log(e),o.redirect("/")})}),module.exports=router;
//# sourceMappingURL=index.min.js.map
